% !TEX TS-program = LuaLaTeXmk

\documentclass[11pt]{article} 
\usepackage{calc}
\usepackage{fontspec}
\usepackage[lmargin=.75in,rmargin=.75in,tmargin=1in,bmargin=1in]{geometry}
\usepackage{titling}

\usepackage{array, booktabs,tabularx}
\usepackage{arydshln}

\usepackage{enumitem}

\usepackage{fancyvrb}

\usepackage{listings}
\usepackage{url}
\usepackage[sf,small]{titlesec}
\usepackage[section]{placeins}
\usepackage[colorlinks=true]{hyperref}

% \setmonofont{Inconsolatazi4}
\usepackage{./recorder-fingering}
\fingeringSetup{width=12pt}
\usepackage{parskip}
\usepackage{musixtex}
\input musixlyr
\usetikzlibrary{tikzmark}
\usetikzlibrary{positioning}

\NewDocumentCommand{\addf}{mm}{\tikz[remember picture]{\node[overlay,above=of pic cs:#2]{\Whistle{#1}};}}
\DefineShortVerb{\|}

\title{Lord Of The Rings -- Concerning Hobbits}
\author{Charles-Albert Lehalle}
\date{Version 1.0\\July 15, 2023}
  
\lstset{%
    basicstyle=\ttfamily\small,
    commentstyle=\itshape\ttfamily\small,
    showspaces=false,
    showstringspaces=false,
    breaklines=true,
    breakautoindent=true,
    language=TeX,
    frame=tl,
}
  
\newcommand*{\pkg}[1]{\texttt{#1}}
\newcolumntype{t}[1]{>{\ttfamily}#1}
\newcolumntype{T}{>{\ttfamily}c}
\newcommand*{\bs}{\textbackslash}
\setlength{\droptitle}{-1in}
\renewcommand{\abstractname}{\sffamily Abstract}

\def\spaceforvbar{\rule{2ex}{0pt}}
\def\mypause{\rule{1.5ex}{0.5pt}}

\begin{document}
\maketitle

\begin{center}
  It comes from \href{https://www.youtube.com/watch?v=pgcVrtltHr4}{CutiePie's youtube channel}.\\[4ex]
  
  {\sc Part 1.A\&B.}

  \begin{tabular}{ccccccc|cccccccc}
    \toprule
    d & e & f\# & a & f\# & e & d & f\# & a & b & $\circ$~D & c\# & a & f\# & $\circ$~e \\
    \midrule
    \Whistle{d} & 
    \Whistle{e} &
    \Whistle{f#} &
    \Whistle{a} &
    \Whistle{f#} & 
    \Whistle{e} & 
    \Whistle{d}\spaceforvbar &
    \Whistle{f#} & 
    \Whistle{a} &
    \Whistle{b} &
    \Whistle{D} &
    \Whistle{c#} &
    \Whistle{a} & 
    \Whistle{f#} & 
    \Whistle{e} \\
    \bottomrule
  \end{tabular}
\end{center}


\begin{center}
  {\sc Part 1.C\&D.}

  \begin{tabular}{ccccccc|cccccc:c}
    \toprule
    d & e & f\# & $\circ$~a & f\# & e & d & f\# & a & b & $\circ$~a &f\# & e & d \\
    \midrule
    \Whistle{d} & 
    \Whistle{e} &
    \Whistle{f#} &
    \Whistle{a} &
    \Whistle{f#} &
    \Whistle{e} & 
    \Whistle{d}\spaceforvbar & 
    \Whistle{f#} & 
    \Whistle{a} & 
    \Whistle{b} & 
    \Whistle{a} & 
    \Whistle{f#} & 
    \Whistle{e}\spaceforvbar & 
    \Whistle{d} \\
    \bottomrule
  \end{tabular}
\end{center}

%

\begin{center}
  {\sc Part 2.A. (+)}

  \begin{tabular}{cccc:ccccc}
    \toprule
    D & E & F\# & F\# & F\# & A & E & (D) & E \\
    \midrule
    \Whistle{D} & 
    \Whistle{E} &
    \Whistle{F#} &
    \Whistle{F#}\spaceforvbar &
    \Whistle{F#} &
    \Whistle{A} & 
    \Whistle{E} & 
    \Whistle{d} & 
    \Whistle{E} \\
    \bottomrule
  \end{tabular}
\end{center}


\begin{center}
  {\sc Part 2.B.}

  \begin{tabular}{ccccccccc}
    \toprule
    a & b & c\# & c\# & D & a & f\# & a & e \\
    \midrule
    \Whistle{a} & 
    \Whistle{b} &
    \Whistle{c#} &
    \Whistle{c#} &
    \Whistle{D} &
    \Whistle{a} & 
    \Whistle{f#} & 
    \Whistle{a} & 
    \Whistle{e} \\
    \bottomrule
  \end{tabular}
\end{center}

%
\clearpage
\begin{center}
  {\sc Part 3.A.}

  \begin{tabular}{ccc:cccc:ccccc}
    \toprule
    d & e & f\# & f\# & b & c\# & D & c\# & a & f\# & e \\
    \midrule
    \Whistle{d} & 
    \Whistle{e} &
    \Whistle{f#}\spaceforvbar &
    \Whistle{f#} &
    \Whistle{b} &
    \Whistle{c#} & 
    \Whistle{D}\spaceforvbar & 
    \Whistle{c#} & 
    \Whistle{a} & 
    \Whistle{f#} & 
    \Whistle{e} \\
    \bottomrule
  \end{tabular}
\end{center}

\begin{center}
  {\sc Part 3.B.}

  \begin{tabular}{ccc:cccc:ccc:ccc}
    \toprule
    d & e & f\# & f\# & b & c\# & D & c\# & v & a & e & d \\
    \midrule
    \Whistle{d} & 
    \Whistle{e} &
    \Whistle{f#}\spaceforvbar &
    \Whistle{f#} &
    \Whistle{b} &
    \Whistle{c#} & 
    \Whistle{D}\spaceforvbar & 
    \Whistle{c#} & 
    \Whistle{b} & 
    \Whistle{a}\spaceforvbar & 
    \Whistle{e} & 
    \Whistle{d} \\
    \bottomrule
  \end{tabular}
\end{center}

\clearpage
\subsection*{Attempt to put MusixTeX and fingering in sync}
\vspace{\heightof{\Whistle{C}}+\baselineskip}
\begin{music} % d & e & f\# & a & f\# & e & d
\setlyrics{scale}{d e f\# a f\# e d}
\lyrraise{1}{b-2ex}
\assignlyrics{1}{scale}
\startextract
\NOTEs
\tikzmark{d:1}\qu{d}
\tikzmark{e:1}\qu{=e}
\tikzmark{f:1}\qu{^f}
\tikzmark{a}\qu{h}
\tikzmark{f:2}\qu{^f}
\tikzmark{e:2}\qu{=e}
\tikzmark{d:2}\qu{d}
\en
\zendextract
\end{music}
\addf{d}{d:1}\addf{e}{e:1}\addf{f#}{f:1}\addf{a}{a}\addf{f#}{f:2}\addf{e}{e:2}\addf{d}{d:2}

\end{document} 



% Local Variables:
% TeX-engine: xetex
% End:
